#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
強度のヒストグラムと様々な分布への当てはめを行った確率密度曲線を重ねて、フィット具合を可視化
"""

import matplotlib.pyplot as plt
import numpy as np

# データ
data = [315.13320503597845, 291.5270214205407, 264.3835456766218, 300.21332895600403, 256.62556220849854, 322.37758719211126, 266.31416036022256, 303.54290563180825, 268.7109296370662, 297.187512977871, 268.6996531275959, 263.87064066223076, 317.8573105244742, 300.0552815792577, 309.8586963364662, 274.6768694759895, 282.44836151726395, 259.0720542564601, 255.01280612595264, 305.95657364713753, 311.0459837487205, 247.91096777040752, 294.4634031444002, 304.1534759830387, 259.58105148196944, 267.90360076209953, 297.9174264559823, 273.4507828299318, 246.55721248855355, 309.274424575026, 299.8311151178795, 302.69510184788163, 303.1703685184315, 241.18620773484614, 259.29047036596063, 275.32245029599596, 295.49077099270846, 291.38668035524057, 251.2233542125004, 272.33014899087357, 286.31362887778823, 307.99034150915145, 304.3870730549021, 267.7037475558765, 283.8888362543121, 272.3076062809429, 264.78554654165686, 260.56879708075115, 275.2138586397176, 301.4199549041806, 266.84475560230413, 250.19961684242463, 268.75287360961585, 274.4060461986871, 310.57993023646145, 303.4501384783998, 316.6453969899203, 257.2218829741486, 314.19509263741145, 261.7985846089431, 263.68068110833156, 278.56431244728003, 296.0477889914511, 277.23026488468184, 276.1224665592042, 290.09046704747595, 273.6401149982192, 300.23396692602864, 268.6123205961532, 284.6075484384919, 254.5716130219745, 269.1296178895084, 296.8553073015063, 263.5186593461722, 312.53314301223406, 248.0438973219606, 274.78352932977305, 260.9590083510062, 306.2951608102955, 308.46396997078295, 303.2569329388883, 269.3510294463135, 263.2539658023008, 317.70851237986324, 259.84200000528335, 244.0830414927223, 289.3615025210477, 300.66723118056507, 262.76369762737704, 276.4696741755929, 279.74589377024273, 263.1395286798392, 274.0377246851811, 287.00359344002857, 300.13755768489654, 295.5820586393028, 252.5928399704226, 277.6483697192638, 279.2670552303826, 282.0361284163925, 314.8927561801152, 297.34096391293804, 286.5079370809085, 312.45816772633395, 273.8932261443762, 284.01084217450097, 243.85850441751342, 294.77688311466784, 286.66870514990643, 288.06947163710953, 291.0466319445121, 282.3253580731728, 282.7684885852206, 297.43514912776226, 271.4265168852646, 243.95864651218102, 273.7443312318017, 295.23102952406094, 293.2945516107366, 317.073078951384, 302.8699560528249, 296.69194505211124, 268.9485849781346, 301.7470074000321, 311.8599033729015, 274.8804639357878, 266.9537985738002, 277.5809025275588, 270.51806199679686, 259.18598552396116, 249.2537927912848, 236.8744174933721, 267.4653591559033, 292.47205591078773, 250.84594706157685]

# ヒストグラムデータ
histogram_centers = [239.0119967358406, 243.28715522077755, 247.5623137057145, 251.83747219065145, 256.11263067558843, 260.38778916052536, 264.66294764546234, 268.9381061303993, 273.21326461533624, 277.4884231002732, 281.76358158521015, 286.0387400701471, 290.31389855508405, 294.58905704002103, 298.864215524958, 303.13937400989494, 307.4145324948319, 311.6896909797689, 315.9648494647058, 320.24000794964275]
histogram_counts = [1, 4, 4, 4, 4, 8, 9, 13, 14, 7, 6, 7, 5, 9, 11, 10, 5, 6, 7, 1]

# 密度曲線用のx軸
x_range = [235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 324, 325, 326, 327, 328, 329, 330, 331, 332, 333, 334, 335, 336, 337, 338, 339, 340, 341, 342, 343, 344, 345, 346]

# 各モデルの密度曲線データ
density_curves = {'single_normal': [0.001529339404893278, 0.0017029892472892804, 0.0018919382003810597, 0.002096954464251878, 0.002318772102143045, 0.0025580801437076893, 0.0028155110743627973, 0.0030916288149107148, 0.003386916315194993, 0.0037017629047494823, 0.004036451561731814, 0.0043911462784152755, 0.004765879716643983, 0.005160541359430093, 0.005574866374793398, 0.006008425414542765, 0.006460615573544416, 0.006930652733736794, 0.0074175655114278065, 0.00792019101602138, 0.008437172613136111, 0.008966959865074, 0.009507810796860975, 0.010057796606822331, 0.010614808907206926, 0.011176569543187943, 0.011740642998217104, 0.0123044513508753, 0.012865291703826148, 0.013420355960104931, 0.013966752776693056, 0.014501531481112885, 0.015021707694625316, 0.01552429036651508, 0.016006309888869363, 0.016464846931099907, 0.01689706160905253, 0.017300222585608434, 0.01767173568879882, 0.01800917163006881, 0.018310292409716402, 0.018573076008797904, 0.018795738986852373, 0.01897675663238778, 0.01911488034774334, 0.019209151991074785, 0.01925891494502139, 0.019263821733181908, 0.019223838060808848, 0.019139243213988924, 0.019010626810809856, 0.018838881957381984, 0.018625194919846086, 0.018371031479443464, 0.018078120190196834, 0.017748432806684675, 0.017384162191836732, 0.016987698050819924, 0.01656160086626554, 0.01610857443182316, 0.015631437395008784, 0.015133094226422176, 0.014616506030703759, 0.014084661605323788, 0.013540549136853217, 0.012987128901314565, 0.012427307306244577, 0.011863912578021682, 0.011299672359710843, 0.010737193443109269, 0.010178943814826362, 0.009627237151097826, 0.009084219850598456, 0.008551860649722423, 0.008031942821524292, 0.007526058918558753, 0.007035607981927053, 0.006561795104529636, 0.006105633206317875, 0.005667946853591692, 0.005249377933339812, 0.004850392977380469, 0.004471291919631929, 0.00411221806311513, 0.003773169031059905, 0.0034540084784592277, 0.0031544783462304515, 0.0028742114493773376, 0.002612744202739079, 0.002369529302571577, 0.0021439481988277612, 0.001935323211083479, 0.0017429291601018082, 0.0015660044065728294, 0.0014037612081720138, 0.0012553953253523619, 0.0011200948248732562, 0.0009970480476721884, 0.0008854507240561137, 0.0007845122341316042, 0.0006934610247639262, 0.0006115492060612077, 0.0005380563603742141, 0.0004722926050810697, 0.0004136009570234097, 0.000361359051442885, 0.0003149802717287875, 0.00027391434834490077, 0.000237647486089031, 0.00020570207849572963, 0.0001776360668716365, 0.00015304199930579458], 'truncated_normal': [0.0015482148335363027, 0.0017240078988156827, 0.0019152888996333277, 0.002122835517359524, 0.0023473908751985213, 0.0025896525069523694, 0.002850260704306119, 0.0031297863480912835, 0.003428718348819976, 0.0037474508412130504, 0.004086270296004087, 0.004445342729493508, 0.004824701206644778, 0.005224233846446144, 0.005643672548305389, 0.006082582664925686, 0.006540353849991274, 0.007016192307690532, 0.0075091146653095036, 0.008017943679611755, 0.008541305972348971, 0.009077631969994938, 0.009625158197754013, 0.010181932048275485, 0.010745819111643075, 0.011314513115563868, 0.011885548483832012, 0.012456315477779966, 0.01302407784034384, 0.01358599281643548, 0.014139133377472538, 0.014680512433156965, 0.015207108770919471, 0.015715894423867675, 0.016203863132563216, 0.016668059535425623, 0.017105608697853082, 0.01751374557198953, 0.017889843968050014, 0.0182314446146893, 0.01853628189034228, 0.018802308819882117, 0.019027719951250535, 0.019210971754645534, 0.019350800221951354, 0.019446235385735536, 0.019496612524527755, 0.019501579873299927, 0.019461102714031578, 0.019375463779817054, 0.01924525996593454, 0.019071395401397864, 0.018855070993494052, 0.018597770614444824, 0.018301244152450262, 0.01796748769789862, 0.017598721178495213, 0.017197363793650815, 0.016766007628011975, 0.016307389846018254, 0.015824363883526215, 0.015319870058722748, 0.014796906022824633, 0.014258497461669222, 0.013707669442654714, 0.013147418778153014, 0.012580687747194065, 0.012010339482721205, 0.011439135292943879, 0.010869714143232016, 0.010304574480604912, 0.009746058537177069, 0.009196339202927239, 0.008657409512808308, 0.008131074749406001, 0.007618947120893649, 0.007122442935632066, 0.006642782160031774, 0.0061809902157152615, 0.005737901845953177, 0.005314166860038486, 0.004910257547823263, 0.004526477545073284, 0.0041629719234855195, 0.003819738276955202, 0.0034966385776765492, 0.0031934115815474315, 0.0029096855716971457, 0.0026449912412993127, 0.0023987745316718942, 0.0021704092584930216, 0.0019592093772641934, 0.0017644407584337981, 0.0015853323623793369, 0.0014210867242948043, 0.0012708896785395337, 0.0011339192708220557, 0.0010093538244129747, 0.0008963791431535095, 0.0007941948491531955, 0.0007020198666062076, 0.0006190970750063044, 0.0005446971651580794, 0.00047812173976321577, 0.0004187057070390068, 0.0003658190208703368, 0.00031886782450088924, 0.0002772950568520785, 0.0002405805813532446, 0.00020824089681947445, 0.00017982848857602403, 0.00015493087585474088], 'weibull': [0, 0, 0.0001255060691367505, 0.0011241943320631346, 0.0021195148628140375, 0.003108492871424765, 0.004088185190084676, 0.005055694865797365, 0.006008185431133956, 0.0069428947547045825, 0.007857148376726599, 0.008748372239651943, 0.009614104729180723, 0.010452007947075346, 0.011259878143933543, 0.012035655247407425, 0.012777431429190949, 0.013483458662356944, 0.014152155229220798, 0.0147821111487514, 0.015372092501550343, 0.015921044639486175, 0.016428094276111072, 0.01689255046291328, 0.01731390446518432, 0.017691828559721665, 0.01802617378466822, 0.018316966679436365, 0.01856440505981003, 0.01876885287990417, 0.018930834238634293, 0.019051026593665733, 0.019130253250436356, 0.019169475197750245, 0.019169782364603993, 0.01913238437532117, 0.019058600881732043, 0.018949851552050537, 0.018807645796282756, 0.018633572307472524, 0.018429288496877395, 0.018196509899308485, 0.017936999622399894, 0.017652557910543758, 0.017345011890685665, 0.017016205563175874, 0.016667990096471044, 0.01630221447973811, 0.015920716582386477, 0.015525314664307514, 0.015117799375192281, 0.01469992627578902, 0.014273408908409231, 0.013839912438451833, 0.013401047883241642, 0.012958366939121856, 0.012513357412546802, 0.012067439255933612, 0.011621961204287712, 0.011178198004151187, 0.010737348222263944, 0.010300532617499407, 0.009868793056159108, 0.00944309194759783, 0.009024312174413662, 0.008613257489080258, 0.008210653346923173, 0.007817148143744856, 0.007433314825177193, 0.007059652833975723, 0.006696590360951906, 0.006344486865053153, 0.006003635828224988, 0.005674267711105115, 0.005356553076282281, 0.0050506058467794145, 0.004756486668565435, 0.004474206347237633, 0.00420372933052053, 0.003944977209871295, 0.003697832216241116, 0.0034621406868903504, 0.003237716482069399, 0.0030243443323334555, 0.0028217830992356896, 0.0026297689341196885, 0.0024480183216891048, 0.0022762309969529674, 0.0021140927260138564, 0.0019612779429687786, 0.0018174522369175813, 0.0016822746847105548, 0.0015554000266071618, 0.0014364806834548005, 0.0013251686153249922, 0.0012211170227609482, 0.0011239818928928326, 0.0010334233936648083, 0.0009491071202912656, 0.0008707051988207451, 0.0007978972523371335, 0.0007303712358728708, 0.0006678241465523074, 0.0006099626158301062, 0.000556503390945524, 0.0005071737128842392, 0.0004617115982319194, 0.0004198660323241192, 0.00038139708105243615, 0.000346075928583616, 0.0003136848480933466, 0.00028401711241634464], 'lognormal': [0.001254551365830037, 0.0014324841303329846, 0.0016293837878089271, 0.0018463294238274285, 0.002084332240786247, 0.002344315655510195, 0.002627094862138925, 0.0029333561966472057, 0.003263636670123378, 0.003618304061795727, 0.003997537978651968, 0.00440131229545326, 0.004829379386312515, 0.005281256546379897, 0.005756214979419177, 0.00625327169431414, 0.006771184611286477, 0.007308451127576774, 0.007863310333565562, 0.00843374900507368, 0.009017511427364334, 0.009612113032843643, 0.010214857759398094, 0.010822858961576346, 0.01143306363427738, 0.0120422796400683, 0.01264720556844885, 0.013244462799866994, 0.013830629300450606, 0.014402274636385149, 0.014955995670521225, 0.01548845238869572, 0.015996403299708178, 0.01647673986086078, 0.016926519400142268, 0.01734299603590617, 0.01772364913440684, 0.018066208893725795, 0.018368678698174424, 0.018629353948778668, 0.018846837141402072, 0.01902004903287427, 0.01914823580555063, 0.01923097221047557, 0.01926816073725675, 0.019260026923480753, 0.019207110976767902, 0.01911025593727485, 0.018970592656704845, 0.018789521910963822, 0.018568693996998828, 0.018309986189769607, 0.018015478452632086, 0.01768742780374148, 0.01732824174267204, 0.0169404511357265, 0.016526682945919136, 0.016089633175039936, 0.015632040361293852, 0.015156659947590792, 0.014666239803486664, 0.014163497148938949, 0.013651097091290004, 0.01313163294910019, 0.012607608498389067, 0.012081422239281622, 0.011555353744637826, 0.0110315521175832, 0.01051202655243899, 0.009998638963800403, 0.009493098621748715, 0.008996958707630513, 0.008511614684659441, 0.008038304360837696, 0.007578109508357326, 0.007131958893645249, 0.006700632565419176, 0.0062847672443500395, 0.005884862656939022, 0.0055012886577674985, 0.00513429298808564, 0.004784009524466176, 0.004450466878676882, 0.004133597218709125, 0.0038332451907535244, 0.0035491768325506792, 0.0032810883797111715, 0.003028614878037634, 0.0027913385263833054, 0.0025687966859413713, 0.0023604895029111844, 0.002165887102081754, 0.0019844363188935487, 0.001815566946889409, 0.0016586974860735675, 0.0015132403855140047, 0.0013786067805210758, 0.0012542107308992352, 0.0011394729721075111, 0.0010338241956953595, 0.000936707879132351, 0.0008475826881662458, 0.0007659244771687536, 0.0006912279146148665, 0.0006230077619493571, 0.0005607998346779813, 0.0005041616746446976, 0.00045267296217561505, 0.0004059356961472821, 0.0003635741691231628, 0.0003252347635533318, 0.0002905855936964698], 'gamma': [0, 0, 1.2817055795729959e-08, 3.596199091244663e-05, 0.0003335835112084307, 0.0012361458675431306, 0.0030826253595639857, 0.0061563385734433405, 0.010663708120614493, 0.01672886914275297, 0.024397173673472754, 0.0336435839861321, 0.04438348007885769, 0.056484317418535906, 0.06977715055419599, 0.08406742101720946, 0.09914466558658344, 0.1147909753252106, 0.1307881529792993, 0.1469235936265369, 0.16299496263428814, 0.1788137742961705, 0.19420798983675347, 0.20902375905574988, 0.22312642881039765, 0.23640093605591958, 0.24875169491481908, 0.2601020774101362, 0.2703935769237622, 0.27958473272649403, 0.28764988348326626, 0.2945778077378257, 0.300370300196303, 0.30504072425363865, 0.3086125736810197, 0.3111180697178333, 0.3125968139626492, 0.3130945123908497, 0.31266178148690776, 0.31135304380581774, 0.3092255172070034, 0.30633829947134655, 0.302751547955791, 0.2985257523013744, 0.2937210969344771, 0.28839690913686167, 0.2826111877615502, 0.2764202071971668, 0.269878190895945, 0.26303704864730354, 0.25594617177089546, 0.24865228049520732, 0.2411993179584195, 0.23362838549871418, 0.22597771417570856, 0.21828266776985367, 0.21057577283133144, 0.20288677168501212, 0.19524269463589702, 0.1876679479541352, 0.18018441454541773, 0.1728115645276395, 0.16556657323543955, 0.15846444445861632, 0.1515181369871565, 0.1447386927839414, 0.1381353653357774, 0.13171574694426347, 0.12548589391048007, 0.11945044874208856, 0.11361275866888737, 0.10797498989399602, 0.10253823713356536, 0.09730262810919761, 0.09226742275511732, 0.08743110698756555, 0.08279148095789932, 0.07834574177444385, 0.07409056073221255, 0.07002215513508617, 0.06613635483278786, 0.06242866362581543, 0.058894315716159655, 0.05552832740084496, 0.05232554421974483, 0.049280683779334124, 0.04638837448060933, 0.04364319038282933, 0.04103968243546024, 0.0385724063091644, 0.03623594705321581, 0.034024940801693625, 0.03193409374448396, 0.029958198571779747, 0.028092148592627576, 0.02633094971933953, 0.024669730500433522, 0.023103750375345313, 0.021628406314595873, 0.020239237999508802, 0.018931931686051992, 0.01770232288799746, 0.016546398005423825, 0.015460295015673312, 0.014440303335266687, 0.013482862953001565, 0.01258456292654052, 0.011742139327249077, 0.010952472710881135, 0.010212585184937485, 0.009519637137139764, 0.008870923683467861], 'mixture_normal_2': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'mixture_truncated_normal': [0.00044036668312688246, 0.0005692887393603517, 0.0007293023717296243, 0.0009258477354793137, 0.0011647385366375755, 0.001452025639858528, 0.001793812851526277, 0.0021960237763638153, 0.00266412182045144, 0.0032027892019584037, 0.0038155750402263395, 0.004504526944656936, 0.005269824661783445, 0.006109437852775867, 0.007018832534561872, 0.00799075171726393, 0.009015094969238862, 0.010078918816077545, 0.01116657496828373, 0.012259996500894484, 0.013339133607349517, 0.014382530945063178, 0.015368028570831534, 0.016273558829961326, 0.017078003151630838, 0.0177620663074638, 0.018309121973636888, 0.01870598285507959, 0.018943551373550145, 0.019017312881165968, 0.018927642129653907, 0.018679904628869346, 0.018284346688494876, 0.01775578036098408, 0.017113081184256022, 0.01637852664127536, 0.01557701087509348, 0.014735175941280196, 0.013880501560285915, 0.013040394068834659, 0.01224131145629371, 0.01150795562071063, 0.01086255603771086, 0.010324261694663987, 0.009908651143036927, 0.009627364471472406, 0.009487856314212725, 0.009493265868571984, 0.009642398253004496, 0.009929811138432719, 0.010346001017728961, 0.010877684241053752, 0.011508168525986549, 0.012217810602616756, 0.012984554654843498, 0.01378454412418918, 0.014592796302053918, 0.015383925193698213, 0.01613289379909275, 0.016815772742265693, 0.017410478660494586, 0.01789746348298181, 0.018260325138007055, 0.018486311628378112, 0.018566693913892884, 0.018496988529817945, 0.018277018037216687, 0.017910805749985395, 0.017406310089714567, 0.016775012690465673, 0.01603138232102691, 0.015192243192895222, 0.014276080789462969, 0.013302320672070713, 0.012290615678021874, 0.011260174613889019, 0.010229161239830758, 0.009214186463168371, 0.008229909740718255, 0.007288758305622359, 0.006400765554266573, 0.005573523263239626, 0.0048122366685143065, 0.0041198671183594856, 0.003497344161146628, 0.002943827568829687, 0.0024569998272282656, 0.0020333708512916904, 0.0016685788480782515, 0.001357674059424782, 0.001095375273666329, 0.0008762922266175311, 0.0006951100829251823, 0.0005467349199941183, 0.0004264014069541967, 0.0003297456173466916, 0.0002528471248853594, 0.00019224523757196556, 0.0001449344883386038, 0.00010834440123152514, 8.030818035058812e-05, 5.902441300362297e-05, 4.30152198305168e-05, 3.108359168067804e-05, 2.2271979719844447e-05, 1.582359023341707e-05, 1.1147303144051182e-05, 7.786695171948052e-06, 5.393306646817087e-06, 3.704039691486929e-06, 2.5224044742257408e-06, 1.7032264878270107e-06]}

# 可視化
plt.figure(figsize=(15, 10))

# ヒストグラム（密度に正規化）
plt.subplot(2, 2, 1)
plt.hist(data, bins=20, density=True, alpha=0.7, color='lightblue', edgecolor='black', label='実際のデータ')
plt.title('ヒストグラムと密度曲線の比較（全体）', fontsize=14)
plt.xlabel('強度 (MPa)')
plt.ylabel('密度')

# 各モデルの密度曲線を描画
colors = ['red', 'blue', 'green', 'orange', 'purple', 'brown', 'pink']
for i, (name, densities) in enumerate(density_curves.items()):
    if densities and any(d > 0 for d in densities):
        plt.plot(x_range, densities, color=colors[i % len(colors)], linewidth=2, label=name)

plt.legend(bbox_to_anchor=(1.05, 1), loc='upper left')
plt.grid(True, alpha=0.3)

# 270付近の詳細表示
plt.subplot(2, 2, 2)
plt.hist(data, bins=20, density=True, alpha=0.7, color='lightblue', edgecolor='black', label='実際のデータ')
plt.title('270MPa付近の詳細（第1ピーク）', fontsize=14)
plt.xlabel('強度 (MPa)')
plt.ylabel('密度')
plt.xlim(250, 290)

for i, (name, densities) in enumerate(density_curves.items()):
    if densities and any(d > 0 for d in densities):
        plt.plot(x_range, densities, color=colors[i % len(colors)], linewidth=2, label=name)

plt.legend(bbox_to_anchor=(1.05, 1), loc='upper left')
plt.grid(True, alpha=0.3)

# 300付近の詳細表示
plt.subplot(2, 2, 3)
plt.hist(data, bins=20, density=True, alpha=0.7, color='lightblue', edgecolor='black', label='実際のデータ')
plt.title('300MPa付近の詳細（第2ピーク）', fontsize=14)
plt.xlabel('強度 (MPa)')
plt.ylabel('密度')
plt.xlim(280, 320)

for i, (name, densities) in enumerate(density_curves.items()):
    if densities and any(d > 0 for d in densities):
        plt.plot(x_range, densities, color=colors[i % len(colors)], linewidth=2, label=name)

plt.legend(bbox_to_anchor=(1.05, 1), loc='upper left')
plt.grid(True, alpha=0.3)

# 下側尾部の詳細表示
plt.subplot(2, 2, 4)
plt.hist(data, bins=20, density=True, alpha=0.7, color='lightblue', edgecolor='black', label='実際のデータ')
plt.title('下側尾部の詳細（235-250MPa）', fontsize=14)
plt.xlabel('強度 (MPa)')
plt.ylabel('密度')
plt.xlim(235, 250)

for i, (name, densities) in enumerate(density_curves.items()):
    if densities and any(d > 0 for d in densities):
        plt.plot(x_range, densities, color=colors[i % len(colors)], linewidth=2, label=name)

plt.legend(bbox_to_anchor=(1.05, 1), loc='upper left')
plt.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('strength_distribution_fit.png', dpi=300, bbox_inches='tight')
plt.show()

print("可視化完了！'strength_distribution_fit.png'に保存されました。")
