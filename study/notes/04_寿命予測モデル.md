# 第4章 寿命を予測しよう (1)

## 4.1 寿命を表現するには？

### 基本概念
- **寿命 (Lifetime)**: 対象としているものが生存している（使用可能である）期間。
- **生存関数 (Survival Function) $S(x)$**:
  $$S(x) = P(X \ge x)$$
  時点 $x$ まで生存している確率。$x=0$ で $S(0)=1$、単調減少して $0$ に近づく。
- **確率密度関数 (Probability Density Function) $f(x)$**:
  $$f(x) = -\frac{dS(x)}{dx}$$
- **ハザード関数 (Hazard Function) $\lambda(x)$**:
  $$\lambda(x) = \frac{f(x)}{S(x)} = -\frac{d \log S(x)}{dx}$$
  時点 $x$ まで生存した個体が、次の瞬間に死を迎える確率（瞬間死亡率）。

### 期待余寿命 $r(x)$
年齢 $x$ まで生存した個体が、その後に死を迎えるまでの平均時間。
$$r(x) = E[X - x | X \ge x] = \frac{1}{S(x)} \int_x^{\infty} S(u) du$$
初期時点 ($x=0$) における期待余寿命は平均寿命 $E[X]$ となる。

## 4.2 寿命予測モデル

### 指数ハザードモデル
ハザード率が常に一定 $\lambda(x) = \theta$であるモデル。
- 生存関数: $S(x) = \exp(-\theta x)$
- 偶発的な故障（ランダム故障）を表現するのに適している。

### ワイブルハザードモデル
ハザード率が時間のべき乗に比例するモデル。生物や機械の磨耗故障によく合う。
- ハザード関数: $\lambda(x) = \theta m x^{m-1}$
- 生存関数: $S(x) = \exp(-\theta x^m)$
- 確率密度関数: $f(x) = \theta m x^{m-1} \exp(-\theta x^m)$

#### パラメータの特徴
- $m$: 形状パラメータ (Shape parameter)
    - $m < 1$: 初期故障型（時間とともにハザード率が下がる）
    - $m = 1$: 偶発故障型（指数分布に一致）
    - $m > 1$: 摩耗故障型（時間とともにハザード率が上がる）
- $\theta$: 尺度パラメータ (Scale parameter) に関連

## Julia 実装メモ
`study/experiments/weibull_hazard.jl` にて、パラメータ $m$ を変化させたときのハザード関数と生存関数の挙動をシミュレーションする。
